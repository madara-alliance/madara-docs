import { Callout } from 'nextra-theme-docs'

# 1) 驴Qu茅 es Madara?

**Madara ha sido construido por el Equipo de Exploraci贸n de Starkware, tambi茅n conocido como *[Keep Starknet Strange](https://github.com/keep-starkne)*, para apoyar 
la [visi贸n de escalado fractal](https://medium.com/starkware/fractal-scaling-from-l2-to-l3-7fe238ecfb4f) que Starkware plante贸 hace a帽os.**

Hay muchas razones por las que uno querr铆a tener su propio L3 en lugar de construir directamente sobre Starknet:

- Hiper-escalabilidad
- Mejor control
- Privacidad
- Interoperabilidad m谩s barata/simplificada

![fractal-scaling](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clggLFBseZKhBSf-oEWhzA.jpeg)

Madara abre todo un nuevo campo de innovaci贸n; los desarrolladores de aplicaciones pueden experimentar con diferentes soluciones de disponibilidad de datos, algoritmos de consenso y esquemas de prueba.

En la secci贸n `Construir en Madara` encontrar谩 informaci贸n detallada sobre las distintas soluciones que se est谩n explorando y sus ventajas y desventajas.

## 2) H

El componente central de Madara es la paleta `Starknet`. Proporciona una capa de compatibilidad Starknet para Substrate. 
Gracias a ella, el c贸digo Cairo existente puede ejecutarse sin problemas.

Esta paleta, adem谩s del m贸dulo RPC, permite la emulaci贸n de bloques Starknet, valida las transacciones codificadas en 
Starknet y hace posible desplegar una DApp Starknet existente en Madara sin ning煤n cambio.

## 3) A

Quiz谩s te preguntes c贸mo podemos asignar bloques de Substrate a bloques de Starknet.

Bueno, utilizamos el m茅todo del [bloque envoltorio](https://corepaper.org/substrate/wrapper/) utilizado por primera vez por Parity en frontier,
la capa de compatibilidad EVM para Substrate.

Wrapper block es una estrategia de Substrate que permite procesar bloques que no se dise帽aron originalmente con Substrate en mente.

A帽ade una ligera sobrecarga de rendimiento, pero es insignificante en comparaci贸n con otros componentes del tiempo de ejecuci贸n.

## La pila Madara

Por ahora, centr茅monos en la visi贸n general de alto nivel y raspemos la superficie de cada una de estas capas.

![stack](../static/img/stack.png)

### Ejecuci贸n

La capa de ejecuci贸n define la forma en que se ejecutan los bloques y se producen las diferencias de estado. Madara facilita el cambio entre dos cajas de ejecuci贸n diferentes, 
[blockifier](https://github.com/starkware-libs/blockifier) de Starkware y [starknet_in_rust](https://github.com/lambdaclass/starknet_in_rust) de LambdaClass.


**Cairo VM**

Bajo el cap贸, siempre se ejecutar谩 el [Cairo VM](https://github.com/lambdaclass/cairo-rs) que est谩 siendo mantenido por Starkware y LambdaClass en Rust. 
Cairo (CPU Algebraic Intermediate Representation) es un lenguaje de programaci贸n para escribir programas demostrables, donde una parte puede probar a otra que un cierto c谩lculo se ejecut贸 correctamente.

- [Cairo Whitepaper](https://eprint.iacr.org/2021/1063) 
- [Cairo 1 Docs](https://www.cairo-lang.org/docs/v1.0/) 
- [Cairo Book](https://cairo-book.github.io/) 

<Callout type="info" emoji="癸">
  ! Se est谩n realizando experimentos para modificar la m谩quina virtual de El Cairo cambiando, por ejemplo, el tama帽o de los campos a Ricitos de Oro, lo que podr铆a suponer un importante aumento del rendimiento.
</Callout>

### Liquidaci贸n

Como Validity Rollup, el estado de cualquier cadena de Madara deber铆a poder construirse 煤nicamente mirando su capa de liquidaci贸n.<br></br>
Madara en s铆 no hace ninguna suposici贸n con respecto a la capa de liquidaci贸n elegida.<br></br>
Si tomamos el ejemplo de un L3, entonces enviar铆a regularmente una prueba a Starknet para un lote de bloques L3.

<Callout type="info" emoji="癸">
  ! Por ejemplo, Starknet liquida actualmente cada ~5 horas, sobre todo por el coste que supone liquidar en Ethereum. Mientras que un L3 podr铆a en la pr谩ctica liquidar mucho m谩s a menudo en Starknet por una fracci贸n del coste.
</Callout>

El t茅rmino de **liquidaci贸n** puede ser enga帽oso, es importante en 煤ltima instancia hacer la diferencia entre la finalidad **SOFT** y **HARD**.

Una vez que se alcanza la firmeza **HARD**, es decir, que la transacci贸n ha sido probada y verificada en la capa de liquidaci贸n, entonces queda grabada en piedra. 
La finalidad **SOFT** es, en 煤ltima instancia, mejorar la experiencia del usuario. Sin embargo, veremos que descentralizando la capa de secuenciaci贸n podemos aspirar a una finalidad **SOFT** bastante fuerte.

### Secuenciaci贸n

La secuenciaci贸n es realizada por Madara y puede ser ajustada de diferentes maneras para adaptarse a sus propias necesidades.

Por ejemplo, podr铆a ser un simple FCFS, PGA o esquemas m谩s complejos como Narwhall & Bullshark o [HotStuff](https://github.com/keep-starknet-strange/madara/issues/180).

El orden de las transacciones es bastante importante para garantizar una buena protecci贸n MEV y asegurar un orden justo de las transacciones. Aunque, en algunos casos como las cadenas espec铆ficas de aplicaciones, se pueden implementar mempools encriptados que garanticen un orden justo.

Madara es por defecto un secuenciador **descentralizado**, m煤ltiples nodos pueden unirse a la red y el consenso por defecto es [GRANDPA  &  BABE](https://docs.substrate.io/learn/consensus/), el utilizado por la mayor铆a de las parachains polkadot. Creemos que aunque los secuenciadores 
centralizados son el est谩ndar de la industria por ahora, descentralizar la capa de secuenciaci贸n es de suma importancia para tener sistemas realmente resistentes a la censura.

### Disponibilidad de datos

En la actualidad, Starknet funciona en modo rollup, tal y como se describe [aqui](https://docs.starknet.io/documentation/architecture_and_concepts/Data_Availability/on-chain-data/). La disponibilidad de datos (DA) significa que el 谩rbol de estados completo est谩 siempre disponible, 
lo que proporciona a los usuarios la seguridad de saber que si StarkEx deja de funcionar alguna vez, pueden demostrar la custodia de sus fondos.

En estos momentos se est谩n experimentando diferentes esquemas de DA para Madara:

- Modo Validium: Los datos est谩n disponibles fuera de la cadena. El Comit茅 de Disponibilidad de Datos (DAC) los almacena, proporcionando una soluci贸n de confianza.
- Celestia
- Eigen DA
- Modo Rollup

Cada modo DA viene con su propio conjunto de suposiciones y los desarrolladores de aplicaciones son libres de experimentar e ir con lo que se sientan m谩s c贸modos.

### Gobernanza

Snapshot X ser铆a la opci贸n principal para el gobierno en Madara, ya que es un sistema de gobierno totalmente en cadena que se basa en pruebas de almacenamiento. 
Ver谩s en los diferentes hacks de Madara, como el de Turbo VM, por qu茅 las pruebas de almacenamiento ser谩n la primera opci贸n de mecanismo de puente dentro del ecosistema de Madara.

Tambi茅n se est谩n explorando otros mecanismos de gobernanza, como la [paleta de gobernanza](https://github.com/keep-starknet-strange/madara/issues/82) de sustratos nativos. 
Teniendo en cuenta lo que hemos visto en el pasado, uno de los valores fundamentales de Madara es la gobernanza en la cadena. Creemos sinceramente que la gobernanza debe ser siempre aplicable en la cadena, como ocurre en los ecosistemas Cosmos y Polkadot.

<Callout type="default" emoji="З">
  Una de las mejores caracter铆sticas que Madara ofrece gracias a estar construida con Substrate es la actualizaci贸n sin **tenedores**. Puedes leer m谩s sobre ello [aqu铆](https://docs.substrate.io/maintain/runtime-upgrades/#:~:text=To%20perform%20a%20forkless%20runtime,part%20of%20the%20consensus%20process).
</Callout>
