import { Steps } from 'nextra-theme-docs'

# Construir sobre Madara

*Uchiwa Madara*<br></br>
En esta secci贸n, te guiaremos a trav茅s del proceso de construcci贸n para que puedas empezar a hackear sobre la pila Madara. 
Pasaremos de ejecutar tu cadena localmente a cambiar el algoritmo de consenso e interactuar con contratos inteligentes en tu propia cadena.

## 1.- Empecemos:

<Steps>

### Instalar dependencias

Primero necesitamos asegurarnos de que tienes todo lo necesario para completar este tutorial.
  
| Dependencia  |  Version | Instalaci贸n |
|---|---|---|
| Rust  | rustc 1.69.0-nightly  | `curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs \| sh` <br></br>`rustup toolchain install nightly` |
| nvm  | latest  | `curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh \| bash` |
| Cairo  | 1.0  | `curl -L https://github.com/franalgaba/cairo-installer/raw/main/bin/cairo-installer \| bash` |  
  
### 2.- Construir la cadena:

Crearemos un CairoVM Rollup a partir del c贸digo fuente de Madara Stack. Podr铆as usar im谩genes docker, pero de esta forma mantenemos la opci贸n de modificar el comportamiento de los componentes si lo necesitas. 
El c贸digo fuente de Madara stack es un monorepo que puedes encontrar [aqu铆](https://github.com/keep-starknet-strange/madara).

```bash
cd ~
git clone git@github.com:keep-starknet-strange/madara.git
```

A continuaci贸n vamos a construir la cadena en modo `release`:

```bash
cd madara
cargo build --release
```

**Cadena de desarrollo de nodo 煤nico**

Este comando iniciar谩 la cadena de desarrollo de nodo 煤nico con estado no persistente:

```bash
./target/release/madara --dev
```

Purgar el estado de la cadena de desarrollo:

```bash
./target/release/madara purge-chain --dev
```

Iniciar la cadena de desarrollo con registro detallado:

```bash
RUST_BACKTRACE=1 ./target/release/madara -ldebug --dev
```

Si todo funciona correctamente, 隆podemos pasar al siguiente paso y crear nuestro propio estado de g茅nesis!


### 3.- Cree su especificaci贸n de cadena:

En primer lugar, ejecute este comando para crear una especificaci贸n de cadena simple

```bash
./target/release/madara build-spec > ./infra/chain-sepcs/chain-spec-plain.json
```

Por defecto, la cadena se ejecutar谩 con la siguiente configuraci贸n :

- [GRANDPA & AURA](https://docs.substrate.io/learn/consensus/#default-consensus-models)
- Un contrato de cuenta de `administrador` en la direcci贸n  `0x0000000000000000000000000000000000000000000000000000000000000001`
- Un contrato de prueba en la direcci贸n `0x0000000000000000000000000000000000000000000000000000000000001111`
- Un token de pago (ETH) en la direcci贸n `0x040e59c2c182a58fb0a74349bfa4769cbbcba32547591dd3fb1def8623997d00`
- La direcci贸n de la cuenta `admin` tiene un saldo `MAX` de fee token
- Un contrato ERC20 en la direcci贸n `0x040e59c2c182a58fb0a74349bfa4769cbbcba32547591dd3fb1def8623997d00`

Esta especificaci贸n de la cadena puede considerarse como la principal fuente de informaci贸n que se utilizar谩 al conectarse a la cadena.

### 4.- *(No disponible a煤n) Despliegue sus contratos inteligentes de liquidaci贸n*

### 5.- Inicie su cadena

Ahora que ya tenemos todo configurado, 隆por fin podemos poner en marcha la cadena! シ

Hay un mont贸n de maneras que usted puede ejecutar la cadena en funci贸n del papel que desea tomar :
- **Nodo completo**<br></br>
Se sincroniza con la cadena para almacenar el estado m谩s reciente de los bloques y las cabeceras de los bloques m谩s antiguos.
- **Nodo de archivo**<br></br>
Mantiene todos los bloques empezando por el bloque g茅nesis con el estado completo disponible para cada bloque.
- **Nodo RPC**<br></br>
Expone una interfaz RPC a trav茅s de puertos HTTP o WebSocket para que los usuarios puedan leer el estado de la cadena de bloques y enviar transacciones. 
A menudo hay varios nodos RPC detr谩s de un equilibrador de carga.
- **Nodo validador**<br></br>
Asegura la cadena apostando alg煤n activo elegido y vota en consenso junto con otros validadores.

Cuando desarrolle su cadena, puede simplemente ejecutarla en modo desarrollador:

```bash
./target/release/madara --dev --execution=native
```
	Si s贸lo te importa exponer el RPC puedes ejecutar lo siguiente :

```bash
./target/release/madara --unsafe-ws-external --rpc-methods Safe --rpc-cors '*' --ws-max-connections 5000
```

Si desea guardar todo el estado de la cadena en una carpeta `/tmp/ :

```bash
./target/release/madara --base-path /tmp/
```

En este caso, tenga en cuenta que puede purgar el estado de la cadena cuando lo desee ejecutando :

```bash
./target/release/madara purge-chain --base-path /tmp
```

### 6.- Despliega una cuenta en tu cadena

Por fin tu cadena est谩 en marcha. 隆Es hora de desplegar tu propia cuenta!

### 7.- Haz algunas transacciones

### 8.- シ

</Steps>
